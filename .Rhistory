<<<<<<< HEAD
pli~ season+ prox.normal+ Q44+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2)
model3<- lmer(data= iw.score,
pli~ season* prox.normal* Q44+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model3)
anova(model3)
step(model3, direction="backward")
#Q13=====
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q13+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2)
#Q18=====
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q18+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2)
#Q67====
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is significant
plot(model2)
model.effects <- allEffects(model2)
plot(model.effects)
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
model.effects <- allEffects(model2)
plot(model.effects) #pollution load increased for people who clean their rood?
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is  significant
model.effects <- allEffects(model2)
plot(model.effects) #pollution load increased for people who clean their rood?
#Q77====
#Does your cistern have a screen/filter for incoming water from down spout on top of the tank?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q77+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is  significant
model.effects <- allEffects(model2)
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = pli_tucson,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_tucson,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is significant
model.effects <- allEffects(model2)
plot(model.effects) #pollution load increased for people who clean their rood?
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = pli_tucson,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_tucson,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data = pli_tucson,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_tucson,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q79 is not significant
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = pli_tucson,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_tucson,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is  significant
anova(model2) #Q76 is not significant
model.effects <- allEffects(model2)
#Q77====
#Does your cistern have a screen/filter for incoming water from down spout on top of the tank?
model1 <- lmer(data = pli_tucson,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_tucson,
pli~ season+ prox.normal+ Q77+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q77 not  significant
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is not significant
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=pli_dewey,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q79 is not significant
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = pli_tucson,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is not significant
#Q77====
#Does your cistern have a screen/filter for incoming water from down spout on top of the tank?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q77+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q77 not  significant
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = pli_globe,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_globe,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is not significant
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = pli_globe,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_globe,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data = pli_globe,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=pli_globe,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q79 is not significant
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = pli_globe,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_globe,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
#Q77====
#Does your cistern have a screen/filter for incoming water from down spout on top of the tank?
model1 <- lmer(data = pli_globe,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_globe,
pli~ season+ prox.normal+ Q77+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q77 not  significant
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=  pli_hayden,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
model2<- lmer(data=  pli_hayden,
pli~ season+ prox.normal+ Q67 +
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is not significant
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = pli_globe,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=  pli_hayden,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_hayden,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_hayden,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is  significantly increasing pollution load
#Q77====
#Does your cistern have a screen/filter for incoming water from down spout on top of the tank?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_hayden,
pli~ season+ prox.normal+ Q77+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q77 not  significant
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
model.effects <- allEffects(model2)
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q79 is not significant
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = iw.score,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= iw.score,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is  significant
summary(model2)
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q67+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is not significant
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=pli_dewey,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q79 is not significant
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q76 is not significant
#Q77====
#Does your cistern have a screen/filter for incoming water from down spout on top of the tank?
model1 <- lmer(data = pli_dewey,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_dewey,
pli~ season+ prox.normal+ Q77+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q77 not  significant
#Q67====
#Do you clean parts of your roof draining system (like the debris filter, gutters, scuppers, etc.)?
model1 <- lmer(data = pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=  pli_hayden,
pli~ season+ prox.normal+ Q67 +
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q67 is not significant
#Q71====
#Do you treat or wash your cistern with anything?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data=  pli_hayden,
pli~ season+ prox.normal+ Q71+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q71 is not significant
#Q79====
#Do you ever remove the screen/filter and leave your cistern without the filter?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_hayden,
pli~ season+ prox.normal+ Q79+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
anova(model2) #Q79 is not significant
#Q76====
#Does your cistern have a first flush?
model1 <- lmer(data =  pli_hayden,
pli ~ (1|community:site),
REML = T) #ML for comparison, REML for final
summary(model1)
model2<- lmer(data= pli_hayden,
pli~ season+ prox.normal+ Q76+
(1|community:site),
REML = F) #ML for comparison, REML for final
summary(model2)
=======
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob, color = "slateblue")) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of Al Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob, color = "black")) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "bulbasaur", spread = 2)+
labs(title = "Probability of Al Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob, color = "black")) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "jigglypuff", spread = 2)+
labs(title = "Probability of Al Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob, color = "slateblue")) +
geom_line(lwd=2) +
# scale_colour_poke(pokemon = "jigglypuff", spread = 2)+
labs(title = "Probability of Al Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob)) +
geom_line(lwd=2, color = "slateblue") +
# scale_colour_poke(pokemon = "jigglypuff", spread = 2)+
labs(title = "Probability of Al Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "dwal_hw_ef.png", res=300, height=6, width=7, units="in")
### tu ----
dwal.tu.0 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Al",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
dwal.tu.1 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Al",],
exceedance ~ prox.normal + season,
family = "binomial")
dwal.tu.2 <- stepAIC(dwal.tu.0,scope = list(upper=dwal.tu.1), direction="both", trace = T)
summary(dwal.tu.2) #prox almost signif
vif(dwal.tu.2)
check_model(dwal.tu.2)
performance(dwal.tu.2)
##arsenic ----
### hw ----
dwas.hw.0 <- glm(data = exhw[exhw$standard=="DW"&exhw$analyte=="As",],
exceedance ~ 1,
family = "binomial")
#maximal model
dwas.hw.1 <- glm(data = exhw[exhw$standard=="DW"&exhw$analyte=="As",],
exceedance ~ prox.normal + season,
family = "binomial")
dwas.hw.2 <- stepAIC(dwas.hw.0,scope = list(upper=dwas.hw.1), direction="both", trace = T)
summary(dwas.hw.2) #both signif
vif(dwas.hw.2)
check_model(dwas.hw.2)
performance(dwas.hw.2)
coefs <- data.frame(t(coef(dwas.hw.2)))
performance(dwas.hw.2)
X1_range <- seq(from=0, to=round(max(exhw$proximity.km),0), by=.01)
winter <- coefs$X.Intercept. + coefs$seasonMonsoon*0 + coefs$prox.normal*X1_range
monsoon <- coefs$X.Intercept. + coefs$seasonMonsoon*1 + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
monsoon.prob <- exp(monsoon)/(1 + exp(monsoon))
plot.data <- data.frame(winter=winter.prob, monsoon=monsoon.prob, X1=X1_range)
plot.data <- gather(plot.data, key=group, value=prob, winter:monsoon)
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of As Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "dwas_hw_ef.png", res=300, height=6, width=7, units="in")
##iron ----
### tu ----
dwfe.tu.0 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Fe",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
dwfe.tu.1 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Fe",],
exceedance ~ prox.normal + season,
family = "binomial")
summary(dwfe.tu.1)
dwfe.tu.2 <- stepAIC(dwfe.tu.0,scope = list(upper=dwfe.tu.1), direction="both", trace = T)
summary(dwfe.tu.2) #season signif
vif(dwfe.tu.2)
check_model(dwfe.tu.2)
exp(coef(dwfe.tu.2))
performance(dwfe.tu.2)
##manganese ----
### gm ----
dwmn.gm.0 <- glm(data = exgm[exgm$standard=="DW"&exgm$analyte=="Mn",],
exceedance ~ 1,
family = "binomial")
#maximal.gm model
dwmn.gm.1 <- glm(data = exgm[exgm$standard=="DW"&exgm$analyte=="Mn",],
exceedance ~ prox.normal + season,
family = "binomial")
dwmn.gm.2 <- stepAIC(dwmn.gm.0,scope = list(upper=dwmn.gm.1), direction="both", trace = T)
summary(dwmn.gm.2) #both signif, trend makes sense
vif(dwmn.gm.2)
check_model(dwmn.gm.2)
exp(coef(dwmn.gm.2))
performance(dwmn.gm.2)
coefs <- data.frame(t(coef(dwmn.gm.2)))
max(exgm$proximity.km)
round(max(exgm$proximity.km),0)
X1_range <- seq(from=0, to=round(max(exgm$proximity.km),0), by=.01)
winter <- coefs$X.Intercept. + coefs$seasonMonsoon*0 + coefs$prox.normal*X1_range
monsoon <- coefs$X.Intercept. + coefs$seasonMonsoon*1 + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
monsoon.prob <- exp(monsoon)/(1 + exp(monsoon))
plot.data <- data.frame(winter=winter.prob, monsoon=monsoon.prob, X1=X1_range)
plot.data <- gather(plot.data, key=group, value=prob, winter:monsoon)
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of Mn Exceedance of Drinking Water Standard",
x = "\nDistance from Globe/Miami Mine (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "dwmn_gm_ef.png", res=300, height=6, width=7, units="in")
### tu ----
dwmn.tu.0 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Mn",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
dwmn.tu.1 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Mn",],
exceedance ~ prox.normal + season,
family = "binomial")
dwmn.tu.2 <- stepAIC(dwmn.tu.0,scope = list(upper=dwmn.tu.1), direction="both", trace = T)
summary(dwmn.tu.2) #both signif, trend makes sense
vif(dwmn.tu.2)
check_model(dwmn.tu.2)
exp(coef(dwmn.tu.2))
performance(dwmn.tu.2)
##lead ----
### tu ----
dwpb.tu.0 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Pb",],
exceedance ~ 1,
family = "binomial")
coefs <- data.frame(t(coef(dwmn.tu.2)))
performance(dwmn.tu.2)
max(extu$proximity.km)
round(max(extu$proximity.km),0)
X1_range <- seq(from=0, to=23, by=.01)
winter <- coefs$X.Intercept. + coefs$seasonMonsoon*0 + coefs$prox.normal*X1_range
monsoon <- coefs$X.Intercept. + coefs$seasonMonsoon*1 + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
monsoon.prob <- exp(monsoon)/(1 + exp(monsoon))
plot.data <- data.frame(winter=winter.prob, monsoon=monsoon.prob, X1=X1_range)
plot.data <- gather(plot.data, key=group, value=prob, winter:monsoon)
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of Mn Exceedance of Drinking Water Standard",
x = "\nDistance from Tucson Air Force Base (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "dwmn_tu_ef.png", res=300, height=6, width=7, units="in")
##zinc ----
### tu ----
dwzn.tu.0 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Zn",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
dwzn.tu.1 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Zn",],
exceedance ~ prox.normal + season,
family = "binomial")
dwzn.tu.2 <- stepAIC(dwzn.tu.0,scope = list(upper=dwzn.tu.1), direction="both", trace = T)
summary(dwzn.tu.2) #both signif, trend makes sense
coefs <- data.frame(t(coef(dwzn.tu.2)))
performance(dwzn.tu.2)
X1_range <- seq(from=0, to=23, by=.01)
winter <- coefs$X.Intercept. + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
plot.data <- data.frame(prob=winter.prob, X1=X1_range)
ggplot(plot.data, aes(x=X1, y=prob)) +
geom_line(lwd=2, color = "slateblue") +
# scale_colour_poke(pokemon = "jigglypuff", spread = 2)+
labs(title = "Probability of Al Exceedance of Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob)) +
geom_line(lwd=2, color = "slateblue") +
# scale_colour_poke(pokemon = "jigglypuff", spread = 2)+
labs(title = "Probability of Zn Exceedance of Drinking Water Standard",
x = "\nDistance from Tucson Air Force Base (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "dwzn_tu_ef.png", res=300, height=6, width=7, units="in")
performance(dwzn.tu.2)
performance(dwpb.tu.2)
dwpb.tu.2 <- stepAIC(dwpb.tu.0,scope = list(upper=dwpb.tu.1), direction="both", trace = T)
##lead ----
### tu ----
dwpb.tu.0 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Pb",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
dwpb.tu.1 <- glm(data = extu[extu$standard=="DW"&extu$analyte=="Pb",],
exceedance ~ prox.normal + season,
family = "binomial")
dwpb.tu.2 <- stepAIC(dwpb.tu.0,scope = list(upper=dwpb.tu.1), direction="both", trace = T)
performance(dwpb.tu.2)
performance(dwzn.tu.2)
check_model(dwzn.tu.2)
#FB/PB ----
##lead ----
### tu ----
fpbpb.tu.0 <- glm(data = extu[extu$standard=="FB"&extu$analyte=="Pb",],
exceedance ~ 1,
family = "binomial")
#maximal.hw model
fpbpb.tu.1 <- glm(data = extu[extu$standard=="FB"&extu$analyte=="Pb",],
exceedance ~ season + prox.normal,
family = "binomial")
fpbpb.tu.2 <- stepAIC(fpbpb.tu.0,scope = list(upper=fpbpb.tu.1), direction="both", trace = T)
summary(fpbpb.tu.2) #nothing signif
#LDW ----
##arsenic ----
### hw ----
ldwas.hw.0 <- glm(data = exhw[exhw$standard=="LDW"&exhw$analyte=="As",],
exceedance ~ 1,
family = "binomial")
#maximal.hw model
ldwas.hw.1 <- glm(data = exhw[exhw$standard=="LDW"&exhw$analyte=="As",],
exceedance ~ prox.normal + season,
family = "binomial")
ldwas.hw.2 <- stepAIC(ldwas.hw.0,scope = list(upper=ldwas.hw.1), direction="both", trace = T)
summary(ldwas.hw.2) #both variables significant with a trend that makes sense
vif(ldwas.hw.2)
check_model(ldwas.hw.2)
exp(coef(ldwas.hw.2))
performance(ldwas.hw.2)
coefs <- data.frame(t(coef(ldwas.hw.2)))
performance(ldwas.hw.2)
X1_range <- seq(from=0, to=round(max(exhw$proximity.km),0), by=.01)
winter <- coefs$X.Intercept. + coefs$seasonMonsoon*0 + coefs$prox.normal*X1_range
monsoon <- coefs$X.Intercept. + coefs$seasonMonsoon*1 + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
monsoon.prob <- exp(monsoon)/(1 + exp(monsoon))
plot.data <- data.frame(winter=winter.prob, monsoon=monsoon.prob, X1=X1_range)
plot.data <- gather(plot.data, key=group, value=prob, winter:monsoon)
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of As Exceedance of Livestock and Poultry Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of As Exceedance of Livestock Drinking Water Standard",
x = "\nDistance from Hayden/Winkelman Smelter (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "ldwas_hw_ef.png", res=300, height=6, width=7, units="in")
##iron ----
### tu ----
ldwfe.tu.0 <- glm(data = extu[extu$standard=="LDW"&extu$analyte=="Fe",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
ldwfe.tu.1 <- glm(data = extu[extu$standard=="LDW"&extu$analyte=="Fe",],
exceedance ~ prox.normal + season,
family = "binomial")
ldwfe.tu.2 <- stepAIC(ldwfe.tu.0,scope = list(upper=ldwfe.tu.1), direction="both", trace = T)
summary(ldwfe.tu.2) #season signif
vif(ldwfe.tu.2)
check_model(ldwfe.tu.2)
exp(coef(ldwfe.tu.2))
performance(ldwfe.tu.2)
## manganese ----
### gm ----
ldwmn.gm.0 <- glm(data = exgm[exgm$standard=="LDW"&exgm$analyte=="Mn",],
exceedance ~ 1,
family = "binomial")
#maximal.gm model
ldwmn.gm.1 <- glm(data = exgm[exgm$standard=="LDW"&exgm$analyte=="Mn",],
exceedance ~ prox.normal + season,
family = "binomial")
ldwmn.gm.2 <- stepAIC(ldwmn.gm.0,scope = list(upper=ldwmn.gm.1), direction="both", trace = T)
summary(ldwmn.gm.2) #both signif, trend makes sense
vif(ldwmn.gm.2)
check_model(ldwmn.gm.2)
exp(coef(ldwmn.gm.2))
performance(ldwmn.gm.2)
coefs <- data.frame(t(coef(ldwmn.gm.2)))
performance(ldwmn.gm.2)
X1_range <- seq(from=0, to=round(max(exgm$proximity.km),0), by=.01)
winter <- coefs$X.Intercept. + coefs$seasonMonsoon*0 + coefs$prox.normal*X1_range
monsoon <- coefs$X.Intercept. + coefs$seasonMonsoon*1 + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
monsoon.prob <- exp(monsoon)/(1 + exp(monsoon))
plot.data <- data.frame(winter=winter.prob, monsoon=monsoon.prob, X1=X1_range)
plot.data <- gather(plot.data, key=group, value=prob, winter:monsoon)
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of Mn Exceedance of Livestock Drinking Water Standard",
x = "\nDistance from Globe/Miami Mine (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "ldwmn_gm_ef.png", res=300, height=6, width=7, units="in")
### tu ----
ldwmn.tu.0 <- glm(data = extu[extu$standard=="LDW"&extu$analyte=="Mn",],
exceedance ~ 1,
family = "binomial")
#maximal.tu model
ldwmn.tu.1 <- glm(data = extu[extu$standard=="LDW"&extu$analyte=="Mn",],
exceedance ~ prox.normal + season,
family = "binomial")
ldwmn.tu.2 <- stepAIC(ldwmn.tu.0,scope = list(upper=ldwmn.tu.1), direction="both", trace = T)
summary(ldwmn.tu.2) #both signif, trend makes sense
vif(ldwmn.tu.2)
check_model(ldwmn.tu.2)
exp(coef(ldwmn.tu.2))
performance(ldwmn.tu.2)
coefs <- data.frame(t(coef(ldwmn.tu.2)))
performance(ldwmn.tu.2)
X1_range <- seq(from=0, to=23, by=.01)
winter <- coefs$X.Intercept. + coefs$seasonMonsoon*0 + coefs$prox.normal*X1_range
monsoon <- coefs$X.Intercept. + coefs$seasonMonsoon*1 + coefs$prox.normal*X1_range
winter.prob <- exp(winter)/(1 + exp(winter))
monsoon.prob <- exp(monsoon)/(1 + exp(monsoon))
plot.data <- data.frame(winter=winter.prob, monsoon=monsoon.prob, X1=X1_range)
plot.data <- gather(plot.data, key=group, value=prob, winter:monsoon)
ggplot(plot.data, aes(x=X1, y=prob, color=group)) +
geom_line(lwd=2) +
scale_colour_poke(pokemon = "charizard", spread = 2)+
labs(title = "Probability of Mn Exceedance of Livestock Drinking Water Standard",
x = "\nDistance from Tucson Air Force Base (km)",
y = "Probability\n",
color = "Season") +
theme_bw() +
theme(text = element_text(family = "Avenir", size = 13),
plot.title = element_text(hjust=.5, face = "bold"),
plot.subtitle = element_text(hjust=.5),
axis.text = element_text(vjust = .5, color = "black"),
# axis.text.x = element_text(angle = 90, vjust = .5, hjust = 1),
legend.position="bottom",
panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.y = element_blank(),
axis.line.x = element_blank())
dev.print(png, "ldwmn_tu_ef.png", res=300, height=6, width=7, units="in")
performance(aimn.gm.2)
check_model(aimn.gm.2)
check_model(aizn.tu.2)
performance(aizn.tu.2)
>>>>>>> d9594a36a5bce74de1209dd1d0c724cfc5920055
